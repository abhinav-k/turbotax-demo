{
  "version": 3,
  "sources": ["../../../../../zustand/vanilla.js", "../../../../../zustand/index.js", "../../../../../zundo/src/index.ts", "../../../../../zundo/src/temporal.ts"],
  "sourcesContent": ["'use strict';\n\nvar createStoreImpl = function createStoreImpl(createState) {\n  var state;\n  var listeners = new Set();\n  var setState = function setState(partial, replace) {\n    var nextState = typeof partial === 'function' ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      var _previousState = state;\n      state = (replace != null ? replace : typeof nextState !== 'object') ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach(function (listener) {\n        return listener(state, _previousState);\n      });\n    }\n  };\n  var getState = function getState() {\n    return state;\n  };\n  var subscribe = function subscribe(listener) {\n    listeners.add(listener);\n    return function () {\n      return listeners.delete(listener);\n    };\n  };\n  var destroy = function destroy() {\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn('[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.');\n    }\n    listeners.clear();\n  };\n  var api = {\n    setState: setState,\n    getState: getState,\n    subscribe: subscribe,\n    destroy: destroy\n  };\n  state = createState(setState, getState, api);\n  return api;\n};\nvar createStore = function createStore(createState) {\n  return createState ? createStoreImpl(createState) : createStoreImpl;\n};\nvar vanilla = (function (createState) {\n  if (process.env.NODE_ENV !== 'production') {\n    console.warn(\"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\");\n  }\n  return createStore(createState);\n});\n\nexports.createStore = createStore;\nexports.default = vanilla;\n\nmodule.exports = vanilla;\nmodule.exports.createStore = createStore;\nexports.default = module.exports;\n", "'use strict';\n\nvar vanilla = require('zustand/vanilla');\nvar react$1 = require('react');\nvar useSyncExternalStoreExports = require('use-sync-external-store/shim/with-selector');\n\nvar useSyncExternalStoreWithSelector = useSyncExternalStoreExports.useSyncExternalStoreWithSelector;\nfunction useStore(api, selector, equalityFn) {\n  if (selector === void 0) {\n    selector = api.getState;\n  }\n  var slice = useSyncExternalStoreWithSelector(api.subscribe, api.getState, api.getServerState || api.getState, selector, equalityFn);\n  react$1.useDebugValue(slice);\n  return slice;\n}\nvar createImpl = function createImpl(createState) {\n  if (process.env.NODE_ENV !== 'production' && typeof createState !== 'function') {\n    console.warn(\"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\");\n  }\n  var api = typeof createState === 'function' ? vanilla.createStore(createState) : createState;\n  var useBoundStore = function useBoundStore(selector, equalityFn) {\n    return useStore(api, selector, equalityFn);\n  };\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nvar create = function create(createState) {\n  return createState ? createImpl(createState) : createImpl;\n};\nvar react = (function (createState) {\n  if (process.env.NODE_ENV !== 'production') {\n    console.warn(\"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\");\n  }\n  return create(createState);\n});\n\nexports.create = create;\nexports.default = react;\nexports.useStore = useStore;\nObject.keys(vanilla).forEach(function (k) {\n  if (k !== 'default' && !exports.hasOwnProperty(k)) Object.defineProperty(exports, k, {\n    enumerable: true,\n    get: function () { return vanilla[k]; }\n  });\n});\n\nmodule.exports = react;\nmodule.exports.create = create;\nmodule.exports.useStore = useStore;\nmodule.exports.createStore = vanilla.createStore;\nexports.default = module.exports;\n", "import type {\n  StateCreator,\n  StoreMutatorIdentifier,\n  Mutate,\n  StoreApi,\n} from 'zustand';\nimport { createVanillaTemporal } from './temporal';\nimport type { TemporalState, Write, ZundoOptions } from './types';\n\ntype Zundo = <\n  TState,\n  Mps extends [StoreMutatorIdentifier, unknown][] = [],\n  Mcs extends [StoreMutatorIdentifier, unknown][] = [],\n  UState = TState,\n>(\n  config: StateCreator<TState, [...Mps, ['temporal', unknown]], Mcs>,\n  options?: ZundoOptions<TState, UState>,\n) => StateCreator<\n  TState,\n  Mps,\n  [['temporal', StoreApi<TemporalState<UState>>], ...Mcs]\n>;\n\ndeclare module 'zustand/vanilla' {\n  interface StoreMutators<S, A> {\n    temporal: Write<S, { temporal: A }>;\n  }\n}\n\nconst zundoImpl =\n  <TState>(\n    config: StateCreator<TState, [], []>,\n    {\n      partialize = (state: TState) => state,\n      handleSet: userlandSetFactory = (handleSetCb) => handleSetCb,\n      ...restOptions\n    } = {} as ZundoOptions<TState>,\n  ): StateCreator<TState, [], []> =>\n  (set, get, _store) => {\n    type TState = ReturnType<typeof config>;\n    type StoreAddition = StoreApi<TemporalState<TState>>;\n\n    const temporalStore = createVanillaTemporal<TState>(set, get, {\n      partialize,\n      ...restOptions,\n    });\n\n    const store = _store as Mutate<\n      StoreApi<TState>,\n      [['temporal', StoreAddition]]\n    >;\n    const { setState } = store;\n\n    // TODO: should temporal be only temporalStore.getState()?\n    // We can hide the rest of the store in the secret internals.\n    store.temporal = temporalStore;\n\n    const curriedUserLandSet = userlandSetFactory(\n      temporalStore.getState().__internal.handleUserSet,\n    );\n\n    const modifiedSetState: typeof setState = (state, replace) => {\n      const pastState = partialize(get());\n      setState(state, replace);\n      curriedUserLandSet(pastState);\n    };\n    store.setState = modifiedSetState;\n\n    const modifiedSetter: typeof set = (state, replace) => {\n      // Get most up to date state. Should this be the same as the state in the callback?\n      const pastState = partialize(get());\n      set(state, replace);\n      curriedUserLandSet(pastState);\n    };\n\n    return config(modifiedSetter, get, _store);\n  };\n\nexport const temporal = zundoImpl as unknown as Zundo;\nexport type { ZundoOptions, Zundo, TemporalState };\n", "import { createStore, type StoreApi } from 'zustand';\nimport type { TemporalStateWithInternals, WithRequired, ZundoOptions } from './types';\n\nexport const createVanillaTemporal = <TState>(\n  userSet: StoreApi<TState>['setState'],\n  userGet: StoreApi<TState>['getState'],\n  {\n    partialize,\n    equality,\n    onSave,\n    limit,\n  } = {} as Omit<WithRequired<ZundoOptions<TState>, | 'partialize'>, 'handleSet'>,\n) => {\n\n  return createStore<TemporalStateWithInternals<TState>>()((set, get) => {\n    return {\n      pastStates: [],\n      futureStates: [],\n      undo: (steps = 1) => {\n        const ps = get().pastStates.slice();\n        const fs = get().futureStates.slice();\n        if (ps.length === 0) {\n          return;\n        }\n\n        const skippedPastStates = ps.splice(ps.length - (steps - 1));\n        const pastState = ps.pop();\n        if (pastState) {\n          fs.push(partialize(userGet()));\n          userSet(pastState);\n        }\n\n        fs.push(...skippedPastStates.reverse());\n        set({ pastStates: ps, futureStates: fs });\n      },\n      redo: (steps = 1) => {\n        const ps = get().pastStates.slice();\n        const fs = get().futureStates.slice();\n        if (fs.length === 0) {\n          return;\n        }\n\n        const skippedFutureStates = fs.splice(fs.length - (steps - 1));\n        const futureState = fs.pop();\n        if (futureState) {\n          ps.push(partialize(userGet()));\n          userSet(futureState);\n        }\n\n        ps.push(...skippedFutureStates.reverse());\n        set({ pastStates: ps, futureStates: fs });\n      },\n      clear: () => {\n        set({ pastStates: [], futureStates: [] });\n      },\n      trackingStatus: 'tracking',\n      pause: () => {\n        set({ trackingStatus: 'paused' });\n      },\n      resume: () => {\n        set({ trackingStatus: 'tracking' });\n      },\n      setOnSave: (onSave) => {\n        set((state) => ({ __internal: { ...state.__internal, onSave } }));\n      },\n      __internal: {\n        onSave,\n        handleUserSet: (pastState) => {\n          const { trackingStatus, pastStates, __internal } = get();\n          const ps = pastStates.slice();\n          const currentState = partialize(userGet());\n          if (\n            trackingStatus === 'tracking' &&\n            !equality?.(currentState, pastState)\n          ) {\n            if (limit && ps.length >= limit) {\n              ps.shift();\n            }\n            ps.push(pastState);\n            __internal.onSave?.(pastState, currentState);\n            set({ pastStates: ps, futureStates: [] });\n          }\n        },\n      },\n    };\n  });\n};\n"],
  "mappings": "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",
  "names": ["createStoreImpl", "setState", "getState", "subscribe", "destroy", "createStore", "createImpl", "useBoundStore", "create", "onSave"]
}
